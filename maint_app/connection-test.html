<!DOCTYPE html>
<html>
<head>
    <title>Status Update Test</title>
</head>
<body>
    <h2>Status Update Test</h2>
    
    <div>
        <p>Part ID: 6 (Protect)</p>
        <select id="statusSelect">
            <option>Needs Work</option>
            <option>Parts On Order</option>
            <option>In Progress</option>
            <option>Complete</option>
        </select>
        <button onclick="testUpdate()">Test Update</button>
    </div>

    <div id="result" style="margin-top: 20px;"></div>

    <script>
        const API_URL = 'https://script.google.com/macros/s/AKfycbzL9ffrICvYzdGEnDoj_DV2zoJZQC2wPigydwaG4MZLwAboOwPGBC3BJFsVFn8qt8x0Ww/exec';

        function sanitizeStatus(status) {
            return status.split(' ').join('+').toUpperCase();
        }

        function testUpdate() {
            const status = document.getElementById('statusSelect').value;
            const sanitizedStatus = sanitizeStatus(status);
            const resultDiv = document.getElementById('result');
            
            // Create the URL with all parameters
            const url = `${API_URL}?action=updateCell&partId=6&columnName=Status&newValue=${sanitizedStatus}`;
            
            // Open the URL in a new window/tab
            window.open(url, '_blank');
            
            resultDiv.textContent = 'Update request sent. Check the new tab and the sheet.';
        }
    </script>
</body>
</html>
